(this.webpackJsonptrafficweatherwatcher=this.webpackJsonptrafficweatherwatcher||[]).push([[0],{105:function(e,t,a){},107:function(e,t,a){},126:function(e,t,a){},186:function(e,t,a){},188:function(e,t,a){},196:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),c=a.n(o),s=(a(103),a(104),a(105),a(19)),i=a.n(s),l=a(37),u=a(80),d=a(81),m=a(96),_=a(83),f=a(97),h=a(202),p=a(203),g=a(92),v=a(204),E=(a(107),a(18)),w=a.n(E),b=a(41),y=a.n(b),S="https://api.data.gov.sg/v1/transport/traffic-images",N="https://developers.onemap.sg/privateapi/commonsvc/revgeocode",O="https://api.data.gov.sg/v1/environment/2-hour-weather-forecast",T="https://developers.onemap.sg/privateapi/auth/post/getToken",x=[[1.437702,103.755741],[1.388622,103.740292],[1.366999,103.777714],[1.363224,103.829212],[1.361164,103.859596],[1.419512,103.898735],[1.473053,103.824234],[1.438732,103.75557]],j=[[1.36593,103.778318],[1.324399,103.758405],[1.299687,103.755315],[1.270855,103.736432],[1.22795,103.681501],[1.218383,103.609403],[1.280167,103.611463],[1.33577,103.632749],[1.406475,103.662961],[1.432216,103.684247],[1.450406,103.718236],[1.438024,103.756276],[1.38873,103.740369],[1.366555,103.778573]],k=[[1.324801,103.758498],[1.314055,103.859828],[1.36116,103.85941],[1.366909,103.778724]],C=[[1.32418,103.759234],[1.273038,103.748248],[1.254847,103.784983],[1.239057,103.836825],[1.277157,103.872187],[1.314227,103.860171],[1.324647,103.75978]],R=[[1.41994,103.899283],[1.361147,103.859596],[1.313641,103.86044],[1.278187,103.87319],[1.307877,103.942198],[1.313025,103.992323],[1.312682,104.031119],[1.355253,104.041085],[1.394037,104.087091],[1.411541,104.086747],[1.434537,104.053445],[1.443461,104.037652],[1.422181,103.99199],[1.429389,103.942209],[1.420808,103.899637],[1.41954,103.89922]],D=a(39),H=a.n(D),I=a(29),M=a(84),W=a.n(M),A=a(132),K=a(147),L=a(146);a(126);function F(e){var t=Object(n.useState)(null),a=Object(I.a)(t,2),o=a[0],c=a[1],s=e.set_current_date;return r.a.createElement("div",{className:"datetime-parent"},r.a.createElement("div",{className:"textLabel"},"Date:"),r.a.createElement(W.a,{selected:o,onChange:function(e){return function(e){console.log(o),c(e),s(e)}(e)},showTimeSelect:!0,showYearDropdown:!0,timeFormat:"HH:mm",timeIntervals:15,timeCaption:"time",dateFormat:"MMMM d, yyyy h:mm aa",placeholderText:"Select a date and time",popperModifiers:{preventOverflow:{enabled:!0}},maxDate:Object(A.default)(new Date,1),minTime:Object(K.default)(Object(L.default)(new Date,0),0),maxTime:Object(K.default)(Object(L.default)(new Date,45),23)}))}var G=a(205),U=a(95),z=r.a.forwardRef((function(e,t){var a=e.children,o=e.style,c=e.className,s=e["aria-labelledby"],i=Object(n.useState)(""),l=Object(I.a)(i,2),u=l[0],d=l[1];return r.a.createElement("div",{ref:t,style:o,className:c,"aria-labelledby":s},r.a.createElement(U.a,{autoFocus:!0,className:"mx-3 my-2 w-auto",placeholder:"Type to filter...",onChange:function(e){return d(e.target.value)},value:u}),r.a.createElement("ul",{className:"list-unstyled"},r.a.Children.toArray(a).filter((function(e){return!u||e.props.children.toLowerCase().startsWith(u)}))))}));a(186);function B(e){var t={},a=e.location_data,n=e.set_current_traffic_data,o=e.set_current_road,c=e.location_list_toggle;return r.a.createElement("div",{className:"dropdown-roads"},r.a.createElement(G.a,null,r.a.createElement(G.a.Toggle,{disabled:c,variant:"success",id:"dropdown-basic",style:{maxHeight:"50px"}},"List of locations"),r.a.createElement(G.a.Menu,{as:z},a.map((function(e,a){var c="Unable to pinpoint location";return e.data.GeocodeInfo.length>0&&(c=e.data.GeocodeInfo[0].ROAD,t[c]=c in t?t[c]+1:1,t[c]>1&&(c=c+"_"+t[c])),r.a.createElement(G.a.Item,{as:"button",value:c,eventKey:a,key:a,onSelect:function(e){return function(e){n(e)}(e)},onClick:function(e){return function(e){e.preventDefault(),o(e.target.value)}(e)}},c)})))))}a(188);function J(e){var t=Object(n.useState)("NORTH"),a=Object(I.a)(t,2),o=a[0],c=a[1],s=e.rev_geocode,i=function(e){s(e),c(e)};return r.a.createElement(G.a,{className:"region-dropdown"},r.a.createElement(G.a.Toggle,{variant:"success",id:"dropdown-basic",style:{maxHeight:"50px"}},"Current Region: ",o),r.a.createElement(G.a.Menu,null,r.a.createElement(G.a.Item,{eventKey:"NORTH",onSelect:function(e){return i(e)}},"North"),r.a.createElement(G.a.Item,{eventKey:"SOUTH",onSelect:function(e){return i(e)}},"South"),r.a.createElement(G.a.Item,{eventKey:"CENTRAL",onSelect:function(e){return i(e)}},"Central"),r.a.createElement(G.a.Item,{eventKey:"EAST",onSelect:function(e){return i(e)}},"East"),r.a.createElement(G.a.Item,{eventKey:"WEST",onSelect:function(e){return i(e)}},"West")))}var q=function(e){var t=e.weather_data;return r.a.createElement("div",null,r.a.createElement("h6",null,"2 Hr Weather Forecast"),r.a.createElement("h6",null,"Area: ".concat(t.area)),r.a.createElement("h6",null,"Weather Conditions: ".concat(t.forecast)))},P=a(32),Y=a.n(P);function $(e,t,a,n){var r=.017453292519943295,o=Math.cos,c=.5-o((a-e)*r)/2+o(e*r)*o(a*r)*(1-o((n-t)*r))/2;return 12742*Math.asin(Math.sqrt(c))}var Q=a(93),V=a.n(Q),X="saimun92@icloud.com",Z="password123";function ee(){return(ee=Object(l.a)(i.a.mark((function e(){var t,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={email:X,password:Z},e.prev=1,e.next=4,w()({method:"post",url:T,data:V.a.stringify(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 4:return a=e.sent,n=a.data,e.abrupt("return",n);case 9:e.prev=9,e.t0=e.catch(1),e.t0.response&&console.log(e.t0.response);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var te=function(e){return e.map((function(e){return w.a.get(N,{params:{location:"".concat(e.location.latitude,",").concat(e.location.longitude),buffer:50,token:y.a.get("token")}})}))},ae=a(206);function ne(){return r.a.createElement(ae.a,{variant:"danger"},"No results retrieved at the selected date. Please select another date.")}var re=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(_.a)(t).call(this,e))).fetch_traffic_and_weather_data=Object(l.a)(i.a.mark((function e(){var t,n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading_button:!0,error_message:!1}),t=6e4*(new Date).getTimezoneOffset(),n=new Date(a.state.current_date-t).toISOString().split(".")[0],e.prev=3,e.next=6,w.a.get(S,{params:{date_time:n}});case 6:return r=e.sent,e.next=9,w.a.get(O,{params:{date_time:n}});case 9:o=e.sent,H.a.isEmpty(r.data.items[0])?a.setState({loading_button:!1,error_message:!0}):a.setState({image_data:r.data.items[0].cameras,weather_data:o.data},(function(){return a.classifying_points_to_regions()})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),e.t0.response&&console.log(e.t0.response);case 16:case"end":return e.stop()}}),e,null,[[3,13]])}))),a.classifying_points_to_regions=function(){for(var e=[],t=[],n=[],r=[],o=[],c=a.state.image_data,s=0;s<c.length;s++){var i=[c[s].location.latitude,c[s].location.longitude];1===Y()(x,i)?1===Y()(C,i)?1===Y()(k,i)?1===Y()(R,i)?1!==Y()(j,i)&&r.push(c[s]):n.push(c[s]):o.push(c[s]):t.push(c[s]):e.push(c[s])}a.setState({Regions:{NORTH:e,SOUTH:t,CENTRAL:o,EAST:n,WEST:r}},(function(){return a.rev_geocode(a.state.current_region)}))},a.rev_geocode=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading_button:!0,location_list_toggle:!0}),n=te(a.state.Regions[t]),e.next=4,w.a.all(n);case 4:r=e.sent,a.setState({location_data:r,current_region:t,loading_button:!1,location_list_toggle:!1});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.set_current_traffic_data=function(e){var t=a.state.Regions[a.state.current_region][e];console.log(t.location),a.setState({current_traffic_data:t,current_index:e},(function(){a.set_current_weather_condition_and_approx_location()}))},a.set_current_road=function(e){a.setState({current_road:e})},a.set_current_weather_condition_and_approx_location=function(){var e=function(e,t){for(var a,n=9999,r=0;r<t.area_metadata.length;r++){var o=$(e.latitude,e.longitude,t.area_metadata[r].label_location.latitude,t.area_metadata[r].label_location.longitude);o<n&&(a=r,n=o)}return a}({latitude:a.state.current_traffic_data.location.latitude,longitude:a.state.current_traffic_data.location.longitude},a.state.weather_data);a.setState({current_weather_data:a.state.weather_data.items[0].forecasts[e]})},a.set_current_date=function(e){a.setState({current_date:e})},a.state={image_data:[],weather_data:[],Regions:{},location_data:[],current_region:"NORTH",current_road:"",current_index:null,current_traffic_data:[],current_weather_data:{},current_date:"",loading_button:!1,location_list_toggle:!1,error_message:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){(function(){return ee.apply(this,arguments)})().then((function(e){y.a.set("token",e.access_token)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(h.a,null,r.a.createElement("h1",{className:"center display-4"},"Traffic Weather Watcher"),r.a.createElement("p",{className:"center lead"},"This is a simple app that displays traffic images and weather forecast."),r.a.createElement("hr",{className:"my-4"}),r.a.createElement(p.a,{className:"center"},r.a.createElement(F,{set_current_date:this.set_current_date}),r.a.createElement("div",{className:"go-button-div"},this.state.loading_button?r.a.createElement(g.a,{variant:"primary",disabled:!0},r.a.createElement(v.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"}),"Loading..."):r.a.createElement(g.a,{className:"go-button",variant:"primary",onClick:this.fetch_traffic_and_weather_data},"Go"))),H.a.isEmpty(this.state.location_data)||this.state.error_message?null:r.a.createElement("div",{className:"controls"},r.a.createElement("div",{className:"control"},r.a.createElement(J,{rev_geocode:this.rev_geocode})),r.a.createElement("div",{className:"break"}),r.a.createElement("div",{className:"control"},r.a.createElement(B,{location_data:this.state.location_data,set_current_traffic_data:this.set_current_traffic_data,set_current_road:this.set_current_road,location_list_toggle:this.state.location_list_toggle}))),this.state.error_message?r.a.createElement("div",{className:"center"},r.a.createElement(ne,null)):null,r.a.createElement("br",null),r.a.createElement("h5",null,this.state.current_road),H.a.isEmpty(this.state.current_traffic_data)||H.a.isEmpty(this.state.current_weather_data)?null:r.a.createElement(p.a,{className:"center"},r.a.createElement("div",{id:"img-container"},r.a.createElement("img",{src:this.state.current_traffic_data.image,alt:""})),r.a.createElement(q,{weather_data:this.state.current_weather_data}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},98:function(e,t,a){e.exports=a(196)}},[[98,1,2]]]);
//# sourceMappingURL=main.d6a9024b.chunk.js.map